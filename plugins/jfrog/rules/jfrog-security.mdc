---
description: Supply-chain security practices when adding or updating dependencies
alwaysApply: false
globs:
  - "**/package.json"
  - "**/package-lock.json"
  - "**/requirements.txt"
  - "**/pyproject.toml"
  - "**/pom.xml"
  - "**/build.gradle"
  - "**/go.mod"
  - "**/Dockerfile"
  - "**/*.csproj"
  - "**/Chart.yaml"
---

jfrog-security:

- When adding or upgrading a dependency, use JFrog MCP tools to check the package for known vulnerabilities and curation status before proceeding.
- Pin dependency versions explicitly; avoid floating ranges like `*` or `latest` in production manifests.
- Prefer packages that are approved in the JFrog Catalog and have no critical or high-severity CVEs.
- If a vulnerability is found, check whether JFrog reports it as applicable to the current usage context before deciding on a fix.
- Never embed credentials, tokens, or registry URLs directly in Dockerfiles or build scripts; use build secrets or environment variables.
- When configuring Docker images, ensure the image reference uses the organization's JFrog registry path.
- Flag any dependency pulled from an untrusted or public registry that bypasses the organization's JFrog proxy repositories.
